# 데브옵스 핸드북(1부 3장 - 두 번째 방법: 피드백 원칙)

**본 내용은 진 킴, 제즈 험블, 패트릭 드부아, 존 윌리스, 『이펙티브 타입스크립트』, 김영기, 김나리 옮김, 에이콘출판주식회사(2018년)를 토대로 작성하였습니다.**



## 개요

* 가치 흐름의 모든 단계에서 우측에서 좌측으로 상호 간 신속하고 지속적인 피드백을 가능하게 하는 원칙
* **더 안전하고 탄력적인 작업 시스템을 만들기**
* 복잡한 시스템에서 작업하는 경우에 특히 중요
  * 대규모 프로덕션 중단이나 고객 데이터 유출로 인한 커다란 실패 발생 가능



## 복잡한 시스템에서 안전하게 작업하기

* 복잡한 시스템에서는 모든 요소가 어떻게 맞춰 동작하는지 확인하기 어려움
  * 컴포넌트의 상호 연결성이 높음
* 복잡한 시스템의 오류 내재는 불가피
  * **치명적인 결과가 발생하기 전에 안전한 작업 시스템을 설계**
* 복잡한 시스템에서 안전하게 작업할 수 있는 조건
  * 복잡한 작업이 관리 되어 설계 및 운영상의 문제점이 드러남
  * 문제점이 넘쳐나고 해결됨으로 새로운 지식을 빠르게 구축
  * 새로운 지역적 지식을 전사적으로 활용
  * 리더는 또 다른 리더를 만듦



### 문제를 발생 시점에 확인하기

* 안전한 작업 시스템에서는 설계와 운영에 대한 가정을 지속적으로 테스트 해야 함
* 문제를 빠르게 찾아 수정하고 학습 및 혁신할 수 있는 능력은 작업 시스템에 피드백과 피드포워드 루프를 생성
  * 시스템 내의 컴포넌트가 서로 보완하거나 대응하도록 함
  * 자동화된 빌드, 통합, 테스트 프로세스를 생성하는 역할도 함
* 퍼베시브 텔레메트리를 생성해 모든 시스템 컴포넌트가 프로덕션 환경에서 동작하는 방법을 확인
  * 예상치 않은 동작을 하면 빠르게 감지
  * 전체 가치 흐르멩서 나오기 때문에 행동이 시스템의 다른 부분에 어떻게 영향을 미치는지 전체적으로 확인 가능



## 새로운 지식 축적을 위한 문제의 스워밍과 해결

* 예상치 못한 상황이 발생했을 때 스워밍해서 문제 해결에 필요한 사람을 동원
* 문제가 다운스트림으로 전파되는 것을 방지
  * 복구 비용과 노력이 늘고 기술 부채가 늘 수 있기 때문
* 워크센터에서 새로운 작업이 시작되는 것을 방지
* 문제 미해결 시, 워크센터의 다음 공정에도 문제가 발생하여 추가적인 비용 발생



## 품질 활동을 원천에 더 가깝게 유지하기

* **복잡한 시스템에 검사, 승인 단계와 같은 프로세스를 추가하면 미래 실패 가능성이 높아짐**
  * 승인 프로세스의 효율성은 의사결정 단계가 실제 작업과 멀리 떨어질 수록 감소
* **업무가 수행되는 곳에서 품질과 안전에 대한 책임을 담당하고 의사결정해야 함**
  * 동료 평가를 통해 변경 사항이 동작할 지 보장 받음
  * 품질 검사를 가능한 자동화함
  * 개발자가 직접 자신의 코드를 테스트, 프로덕션 환경에 배포하도록 함
* 품질과 관련된 책임이 모두의 책임이 되도록 함



## 다운스트림 워크센터 최적화

* **린 방식에 따르면 가장 중요한 고객은 다음 단계의 다운스트림**
  * 내부 고객을 위해 업무를 최적화
  * 내부 고객 문제에 대한 공감대를 형성해야 함
* 아키텍처, 성능, 안정성, 테스트 가능성, 구성 가능성, 보안과 같은 운영상의 비기능적 요구 사항이 높은 우선 순위를 차지하도록 최적화해야함



## 결론

* **기술 가치 흐름에서 좋은 품질, 신뢰성과 안정성을 달성하기 위해서는 빠른 피드백이 중요**
  * 문제 발생시 문제를 바로 확인
  * 스워밍
  * 원천에 가까운 품질 추구
  * 지속적 다운스트림 워크센터 최적환



## 업무 시각화

* 기술 가치 흐름에서는 업무가 보이지 않음
  * 작업을 이동시키기 매우 쉬움
  * 약속을 이행하지 못하거나 문제점이 다운스트림 워크센터로 전달되기도 함
  * **불완전한 정보로 인한 팀 간 업무 미루기가 계속 될 수 있음**
* **작업을 시각화하여 기술 가치 흐름을 관리**
  * 칸반 보드나 스프린트 계획 보드
  * 좌측 -> 우측으로 진행
  * 보드에 카드가 올라간 이후 ~ 완료 컬럼으로 이동까지의 리드타임 측정 가능
  * 이상적인 칸반 보드는 전체 가치 흐름에 걸쳐 있음
  * **애플리케이션이 프로덕션 환경에서 성공적으로 실행되고 고객에게 가치를 제공해야만 작업 완료**



## 진행 중인 작업(WIP) 제한하기

* 생산 분야보다 기술 분야에서의 업무는 더 역동적
* 여러 프로젝트에 배정된 엔지니어의 업무를 태스크마다 전환해야 하면, 그만큼 비용이 발생
* **멀티 태스킹 상태일 때는 간단한 작업이라도 많은 시간이 걸림**
* 각 컬럼에 대한 WIP를 제한 혹은 추가할 수 있는 카드 상한을 두도록 함
* **대기열의 크기 제어(WIP)는 리드타임에 대한 주된 지표 중 하나로 매우 강력한 도구**
* **WIP를 제한하면 병목 현상이 일어나고 그 원인을 찾아 문제 해결의 실마리를 찾을 수 있음**



## 배치 작업의 크기 줄이기

* 큰 규모의 배치 작업은 WIP가 급격히 높아짐
  * 가치 흐름의 가변성이 매우 커짐
  * 리드타임이 길어지고 품질이 하락
  * 배치 작업에서 문제가 발견되면, 해당 작업을 폐기해야 함
* **린 생산방식에 따라 배치 크기를 줄이는 노력을 지속적으로 기울여야 함**
* 단일흐름: 배치 크기의 이론전 하한선
  * 각 작업은 한 번에 한 단위가 수행
* 대규모 배치 전략 vs. 소규모 배치 전략 예시
  * 대규모 배치 전략: 가치 흐름을 이루는 각각의 작업을 순차적으로 수행
  * 소규모 배치 전략: 가치 흐름을 이루는 모든 작업을 순차적으로 수행
  * 더 빠른 리드타임과 신속한 오류 감지를 통해 재감지를 줄이는 결과로 가져옴



## 핸드오프 횟수 줄이기

* 가치 흐름을 통해 코드를 전송하기 위해서는 기능 테스트, 통합 테스트, 환경 생성, 서버 관리 등의 다수 작업을 수행하는 다양한 부서가 필요
* 작업이 팀에서 팀으로 넘어갈 때마다 요청, 지정, 신호, 조정 및 우선순위 지정 등의 의사소통이 필요함
* **핸드오프 작업 시에는 필연적으로 일부 지식이 손실**
  * 핸드오프로 인해 목표를 잃어버릴 수 있음
* **업무의 상당 부분을 자동화 하여 팀을 재구성하고 핸드오프 횟수를 줄여야 함**



## 제약조건을 지속적으로 확인하고 향상시키기

* **시스템의 제약조건을 지속적으로 확인하고 작업 용량을 개선**
* 병목 지점 이전에 위치한 워크센터를 개선하면, 작업이 훨씬 더 빨리 쌓임
* 병목 지점 이후에 위치한 워크센터를 개선하면, 병목지점이 기아 상태로 유지되어 이 지점이 없어짐
* 다섯 가지 집중 단계
  * 시스템의 제약조건을 확인
  * 시스템의 제약조건을 어떻게 활용할 것인지 결정
  * 위 결정에 다른 모든 사항을 종속
  * 시스템의 제약 조건을 향상
  * 제약 조건 제거시, 1단계로 되돌아 감
* 제약 조건 개선 방향
  * 환경 생성: 자체적인 작업 가능한 환경을 생성하여 언제나 사용할 수 있도록 함
  * 코드 배포: 완전한 배포 자동화를 목표
  * 테스트 설정 및 실행: 테스트를 자동화해 배포를 안전히 병렬로 진행하여 테스트 코드가 개발 속도를 따라갈 수 있도록 함
  * 과도하게 타이트한 아키텍처: 느슨하게 결합된 아키텍처를 구축



## 가치 흐름에서 어려움과 낭비 제거하기

* 지속적 학습을 통한 일상 업무에서의 어려움과 고통을 줄이기
* 낭비와 어려움의 범주
  * 미완성 작업: 가치 흐름 내 작업 중 완료되지 않았거나 대기열의 모든 작업, 시간이 흐름으로 쓸모없게 됨
  * 추가 프로세스: 고객에게 가치를 제공하지 않는 모든 추가 작업. 리뷰나 승인
  * 추가 기능: 고객이 필요로 하지 않는 기능
  * 작업 전환: 사람들이 여러 프로젝트와 가치 흐름에 배정되어 부가적인 비용 발생
  * 대기: 작업을 완료할 수 있을 때까지 대기하도록 만드는 작업 사이의 모든 지연
  * 동작: 하나의 워크 센터에서 다른 워크센터로의 이동에 필요한 노력의 양
  * 결함: 정보, 자료 및 제품의 부정확함, 누락, 불명확함. 결함 발생과 감지 시간이 길수록 결함 해결이 더 어려워 짐
  * 비표준 및 수동 작업
  * 용단



## 결론

* 흐름 개선은 데브옵스 성과 달성에 필수적
  * 업무 시각화
  * WIP 제한
  * 배치 크기와 이관 횟수 줄이기
  * 제약 조건의 지속적인 확인과 향상
  * 일상 업무에서의 어려움 제거



## 용어 정리

1. 다운스트림 vs. 업스트림
   * 다운스트림: 최종 사용자가 사용하는 배포본을 빌드하는 개인 또는 조직
   * 업스트림: 코드 작성자 또는 유지보수 사용자

# Reference

