# 24장 클로저(1)

**본 내용은 모던 자바스크립트 Deep Dive - 자바스크립트의 기본 개념과 동작 원리를 토대로 작성하였습니다.**

## 24.0 클로저란?

*  MDN: 클로저는 함수와 **그 함수가 선언된 렉시컬 환경**과의 조합
* 클로저는 함수를 일급 객체를 취급하는 함수형 프로그래밍 언어에서 중요한 특성
* 중첩함수에서 외부 함수의 변수를 참조할 때, 외부 함수의 생명 주기가 다했음에도 불구하고 외부 함수의 식별자를 참조 가능한 것



## 24.1 렉시컬 스코프

* 함수를 어디에 정의했는지에 따라 상위 스코프를 결정하는 것
  * 정적 스코프
* 스코프의 실체는 실행 컨텍스트의 렉시컬 환경
* 렉시컬 환경은 외부 렉시컬 환경에 대한 참조를 포함
  * 상위 렉시컬 환경과 연결
* 함수가 정의된 시점에서 외부 렉시컬 환경에 대한 참조가 정해짐
  * 정의된 시점읜 상위 스코프 === 외부 렉시컬 환경에 대한 참조



## 24.2 함수 객체의 내부 슬롯

* [[Environment]]
  * 함수 객체의 내부 슬롯에 자신이 정의된 시점에서의 상위 스코프를 저장
* **함수 정의가 평가되어 함수 객체 생성시에 저장**



## 24.3 클로저와 렉시컬 환경

### 24.3.1 클로저 예시

```JavaScript
const cat = 'siru';

function outer() {
  const cat = 'nunu';
  
  function inner() {
    console.log(cat);
  }
  
  return inner;
}

const innerFunc = outer(); // inner 함수를 리턴

intterFunc(); // nunu
```



### 24.3.2 예시 설명

* outer 함수는 식별자 innerFunc에 inner 함수를 return하므로 그 생명 주기가 끝
* 그러나, innerFunc를 호출시 outer 함수의 식별자인 cat을 참조하여 inner가 호출



### 24.3.3 클로저

* **외부 함수보다 중첩 함수가 더 오래 유지되는 경우 중첩 함수는 외부 함수의 생명 주기가 끝나도 외부 함수의 변수를 참조 가능**
* 중첩 함수의 [[Environment]] 슬롯에 정의된 시점에서의 상위 스코프가 저장되어 있기 때문
* 외부 함수가 종료되더라도, 중첩 함수의 [[Enviroment]] 슬롯에 의해 참조되고 있어 외부 함수의 렉시컬 환경은 소멸되지 않음
  * 가비지 컬렉터의 대상이 아님
  * 가비지 컬렉터는 참조 중인 메모리 공간을 해제하지 않음
