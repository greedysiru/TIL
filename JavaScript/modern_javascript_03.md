## 04장 - 변수

**본 내용은 모던 자바스크립트 Deep Dive - 자바스크립트의 기본 개념과 동작 원리를 토대로 작성하였습니다.**



## 4.1 변수란 무엇인가? 왜 필요한가?

* 애플리케이션은 데이터를 다룸
  * 데이터를 입력 받아 처리 -> 그 결과를 출력
* **데이터를 관리하기 위한 핵심 개념**



### 평가

* Evaluation
* 자바스크립트 엔진이 자바스크립코드를 평가(Evaluation)하려면?
  * 기호(리터럴, Literal)과 연산자(Operator)의 의미를 알고 있어야 함
  * 표현식(Expression)의 의미도 해석(Parsing)할 수 있어야 함



### 컴퓨터와 메모리

* 컴퓨터는 연산과 기억을 수행하는 부품이 나뉘어져 있음
  * CPU를 사용해 연산
  * 메모리를 사용해 기억
* 메모리는 데이터를 저장할 수 있는 메모리 셀의 집합체
  * 메모리 셀 하나의 크기는 1바이트 (8비트)
  * 1바이트 단위로 데이터를 저장 또는 읽음
  * 각 셀은 메모리 주소(Memory address)를 가짐(메모리 공간의 위치)
  * 메모리 주소는 메모리 공간의 위치를 나타내며 0 ~ 메모리의 크기만큼 정수로 표현
* 컴퓨터는 모든 데이터를 2진수로 처리
* 데이터는 메모리상의 임위의 위치(메모리 주소)에 저장되고 CPU는 이 값을 읽어 연산을 수행



### JavaScript에서의 메모리와 변수

* JavaScript는 개발자의 직접적인 메모리 제어를 허용하지 않음
  * 메모리 주소를 통해 값에 접근하는 것은 치명적 오류를 발생시킬 수 있음
  * 기억하고 싶은 값을 메모리에 저장하고, 저장된 값을 읽어 들여 재사용하기 위해 변수 사용
* **변수는 하나의 값을 저장하기 위해 확보한 메모리 공간 자체 또는 그 메모리 공간을 식별하기 위해 붙인 이름**
  * **값의 위치를 가리키는 상징적인 이름**
  * 컴파일러 또는 인터프리터에 의해 값이 저장된 메모리 공간의 주소로 치환되어 실행
  * 변수를 통해 값에 안전하게 접근
* 할당(Assignment): 대입, 저장
  * 변수에 값을 저장하는 것
* 참조(Reference): 변수에 저장된 값을 읽어 들이는 것
* 변수 이름을 통해 변수에 저장된 값의 의미를 명확히 할 수 있음
  * 가독성을 높이는 부수적인 효과



## 4.2 식별자

* **어떤 값을 구별해서 식별할 수 있는 고유한 이름**
* 식별자는 값이 저장되어 있는 메모리 주소와 매핑 관계를 맺어 메모리에 저장됨
* **식별자는 값이 아니라 메모리 주소를 기억**
* 변수, 함수, 클래스 등의 이름은 모두 식별자
  * 메모리 상에 존재하는 어떤 값을 식별할 수 있는 이름은 모두 식별자
* 네이밍 규칙을 준수해야 함
* 선언(Declaration)에 의해 JavaScript 엔진에 식별자의 존재를 알림



## 4.3 변수 선언

* Variable Declaration
* 변수를 생성하는 것
* 값을 저장하기 위한 메모리 공간을 확보(Allocate)하고 메모리 공간의 주소를 연결(Name Binding)해서 값을 저장할 수 있도록 준비하는 것
* JavaScript에서 **변수 선언은 var, let, const 키워드를 사용**
  * ES6 이전에는 var가 유일
* 선언하지 않은 식별자에 접근하는 경우 ReferenceError(참조 에러)가 발생
  * 식별자를 참조하려 했지만 JavaScript 엔진이 등록된 식별자를 찾을 수 없을 때 발생하는 에러




### var

* var 키워드는 여러 단점이 있음
* 함수 레벨 스코프(Function-level scope)를 지원
* 전역 변수가 선언되어 심각한 부작용이 발생
* **선언 단계와 초기화 단계가 동시에 진행**



### 변수 선언문

```JavaScript
var score;
```

1. **선언 단계** : 위와 같은 변수 선언문은 변수 이름을 등록하고 값을 저장할 메모리 공간을 확보
2. **초기화 단계** : 확보된 메모리 공간에는 JavaScript 엔진에 의해 undefined라는 값이 암묵적으로 할당되어 초기화 됨



### 실행 컨텍스트

* Executaion context
* JavaScript 엔진이 소스코드를 평가하고 실행하기 위해 필요한 환경을 제공하고 코드의 실행 결과를 실제로 관리하는 영역
* **모든 식별자는 실행 컨텍스트에 저장 됨**
* 변수 이름과 변수 값은 실행 컨텍스트 내에 key/value 형식인 객체로 등록되어 관리 됨



### 쓰레기 값

* 초기화 단계를 거치지 않으면 확보된 메모리 공간에는 이전에 다른 애플리케이션에서 사용한 값이 남아있을 수 있음
* JavaScript의 var 키워드는 암묵적으로 초기화를 수행하여 이러한 위험으로부터 안전



## 4.4 변수 선언의 실행 시점과 변수 호이스팅

```JavaScript
console.log(score); // undefined

var score; // 변수 선언문
```

* **위와 같은 결과가 일어나는 이유는 변수 선언이 런타임(Runtime)이 아니라 그 이전 단계에서 먼저 실행됨**
* JavaScript 엔진은 소스코드의 평가 과정을 거치면서 소스코드를 실행하기 위한 준비를 함
  * 이 과정에서 모든 선언문을 찾아내 먼저 실행
  * 모든 선언문: 변수 선언문, 함수 선언문 등
* 이로 인해, 변수 선언의 위치에 상관 없이 어디서든지 변수를 참조할 수 있음
* 이를 **호이스팅**이라고 함
  * 변수 선언문이 코드의 선두로 끌어 올려진 것처럼 동작하는 JavaScript 고유의 특징



## 4.5 값의 할당

```javascript
var siru; // 변수 선언
siru = 'babo'; // 변수 할당

var myPet = 'siru'; // 변수 선언과 값의 할당
```

* 변수에 값을 할당할 때는 **할당 연산자 =**를 사용
* 하나의 문으로 단축할 수 있음
  * 단축 표현을 하여도, JavaScript 엔진은 변수 선언과 값의 할당을 2개의 문으로 나누어 각각 실행
  * 이떄, 변수 선언 시점에서 undefined가 할당되어 초기화
  * **값을 할당할 때는 새로운 메모리 공간을 확보하고 그곳에 할당 값을 저장**
* **변수 선언은 런타임 이전에 실행되지만 값의 할당은 런타임에 실행**



## 4.6 값의 재할당

* 이미 값이 할당되어 있는 변수에 새로운 값을 또다시 할당하는 것
* var 키워드로 선언한 변수는 재할당 가능
* **값을 재할당할 수 없으면 상수(Constant)**
  * const 키워드
* 값을 재할당하면, 새로운 메모리 공간을 확보하고 그 메모리 공간에 새로운 값을 저장
  * 변수의 이전 값은 어떤 식별자와도 연결이 되어 있지 않게 되는데, 가비지 콜렉터에 의해 메모리에서 자동 해제됨
  * 언제 해제될 지는 예측 불가



### 가비지 콜렉터

* Garbage collector
* 애플리케이션이 할당(allocate)한 메모리 공간을 주기적으로 검사하여 더 이상 사용하지 않는 메모리를 해제(relaese)
* JavaScript는 가비지 콜렉터를 내장하고 잇는 매니지드 언어로서, 메모리 누수(Memory leak)를 방지



### 언매니지드 언어 vs. 메니지드 언어

* 언매니지드 언어
  * 명시적으로 메모리를 할당하고 해제할 수 있는 저수준(low-level) 메모리 제어 기능 제공
  * 개발자의 역량에 따라 최적의 성능을 확보할 수 있지만, 치명적 오류 발생 가능성이 있음
  * ex) C언어
* 매니지드 언어
  * 메모리의 할당 및 해제를 위한 메모리 관리 기능을 언어 차원에서 담당
  * 메모리 제어를 허용하지 않음
  * 일정한 생산성을 확보하지만, 성능면에서 어느정도의 손실을 감수해야 함



## 4.7 식별자 네이밍 규칙

* 식별자는 특수문자를 제외한 문자, 숫자, 언더스코어(_), 달러 기호($)를 포함할 수 있음
* 식별자는 숫자로 시작하는 것이 허용되지 않음
* 예약어는 식별자로 사용할 수 없음
* 변수는 쉼표(,)로 구분해 하나의 문에서 여러 개를 한번에 선언 가능
  * 가독성이 좋지 않아지므로 추천하지 않음
* 알파벳으로 식별자를 네이밍할 것을 권장
* JavaScript는 대소문자를 구별
* 의미를 명확히 표현할 수 있도록 네이밍할 것



### 네이밍 컨벤션

* Naming convention
* 하나 이상의 영어 단어로 구성된 식별자를 만들 때 가독성 좋게 만들 수 있도록 규정한 명명 규칙
* JavaScript에서는 일반적으로 변수나 함수의 이름에는 camel case 사용
* 생성자, 클래스 이름에는 pascal case 사용

```JavaScript
// camel case
var petName;

// snake case
var pet_name;

// pascal case
var PetName;

// typeHungarianCase
var strPetName; // type + identifier
```

